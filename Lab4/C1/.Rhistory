library(readr)
dados <- read_csv("~/AnaliseDados/Lab4/C1/dados.csv")
View(dados)
library(readr)
dados <- read_csv("~/AnaliseDados/Lab4/C1/dados.csv")
View(dados)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
install.packages('resample')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
dados  = read_csv("dados.csv")
lastfm = na.omit(dados)
glimpse(lastfm)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
glimpse(lastfm)
glimpse(lastfm)
View(dados)
View(dados)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
dados  = read_csv("dados.csv") %>%
filter(file_extension %in% c("js", "py"))
View(dados)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
dados  = read_csv("dados.csv") %>%
filter(file_extension %in% c("js", "py"))
View(dados)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
dados  = read_csv("dados.csv") %>%
filter(file_extension %in% c("js", "py")) %>%
group_by("file_extension")
View(dados)
View(dados)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
dados  = read_csv("dados.csv") %>%
filter(file_extension %in% c("js", "py")) %>%
group_by("month_day")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
dados  = read_csv("dados.csv") %>%
filter(file_extension %in% c("js", "py"))
a = ((12 - dados.the_month) / 10);
View(dados)
a = ((12 - dados$the_month) / 10);
b = dados.the_year - a;
a = ((12 - dados$the_month) / 10);
b = dados$the_year - a;
c = dados$the_month + (12 * a);
d = b / 100;
e = d / 4;
f = 2 - d + e;
g = (int) (365.25 * b);
a = ((12 - dados$the_month) / 10);
b = dados$the_year - a;
c = dados$the_month + (12 * a);
d = b / 100;
e = d / 4;
f = 2 - d + e;
g = (365.25 * b);
h = (int) (30.6001 * (c + 1));
a = ((12 - dados$the_month) / 10);
b = dados$the_year - a;
c = dados$the_month + (12 * a);
d = b / 100;
e = d / 4;
f = 2 - d + e;
g = (365.25 * b);
h = (30.6001 * (c + 1));
i = ((f + g) + (h + dados$month_day) + 5);
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
dados  = read_csv("dados.csv") %>%
filter(file_extension %in% c("js", "py")) %>%
group_by(file_extension)
View(dados)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
dados  = read_csv("dados.csv") %>%
filter(file_extension %in% c("js", "py")) %>%
group_by(the_year)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
theme_set(theme_bw())
dados  = read_csv("dados.csv") %>%
filter(file_extension %in% c("js", "py")) %>%
group_by(the_year) %>%
mutate(wordsm = sum(users))
View(dados)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(gridExtra)
library(ggplot2)
library(plotly)
char <- read.csv('character_list5.csv')
names(char)
filmes <- read.csv('meta_data7.csv')
names(filmes)
dados = filmes %>% left_join(char)
#Removendo colunas irrelevantes
dados <- dados[ -c(2, 5, 10) ]
# Criando o data frame apenas com as personagens femininas e adicionando as colunas necessarias
dados_f <- dados %>% filter(gender == 'f')
dados_f <- dados_f %>% group_by(title, gender) %>% mutate(countf = n())
dados_f <- dados_f %>% group_by(title) %>% mutate(wordsf = sum(words))
# Criando o data frame apenas com os personagens masculinos e adicionando as colunas necessarias
dados_m <- dados %>% filter(gender == 'm')
dados_m <- dados_m %>% group_by(title, gender) %>% mutate(countm = n())
dados_m <- dados_m %>% group_by(title) %>% mutate(wordsm = sum(words))
# Removendo colunas que nao serao utilizadas
dados_f <- dados_f[ -c(4:7)]
dados_m <- dados_m[ -c(4:7)]
# Juntando os dados parar criar o conjunto de dados final
dados <- dados_f %>% left_join(dados_m)
dados <- unique(dados)
# Renomeando as variaveis
names(dados)[names(dados)=="script_id"] <- "Id"
names(dados)[names(dados)=="title"] <- "Filme"
names(dados)[names(dados)=="year"] <- "Ano"
names(dados)[names(dados)=="wordsf"] <- "Palavras.Ditas.por.Mulheres"
names(dados)[names(dados)=="wordsm"] <- "Palavras.Ditas.por.Homens"
names(dados)[names(dados)=="countf"] <- "Numero.de.Mulheres"
names(dados)[names(dados)=="countm"] <- "Numero.de.Homens"
# Excluindo os NA
dados <- na.omit(dados)
names(dados)
ggplot(dados, aes(Ano,Numero.de.Mulheres, color = Palavras.Ditas.por.Mulheres, text = Filme)) + labs(title = "Numero de Mulheres em Filmes por Ano") + geom_jitter() + scale_color_gradient(low="#efa0a3", high="#bc0007")
ggplot(dados, aes(Ano,Numero.de.Homens, color = Palavras.Ditas.por.Homens, text = Filme)) + labs(title = "Numero de Homens em Filmes por Ano") + geom_jitter() + scale_color_gradient(low="#f49fdc", high="#7a0258")
dados1 <- dados %>% group_by(Ano) %>% mutate(medianaM = median(as.numeric(Numero.de.Mulheres)), medianaH = median(as.numeric(Numero.de.Homens)), MedFalaM = median(as.numeric(Palavras.Ditas.por.Mulheres)), MedFalaH = median(as.numeric(Palavras.Ditas.por.Homens)) )
dados1 <- dados1[-c(1,2,4:7)]
dados1 <- unique(dados1)
p <- ggplot(dados1, aes(Ano, medianaM)) + labs(title = "Mediana do N?mero de Mulheres em Filmes por Ano") + geom_line(color = "#597db7") + labs(y = "Mediana de Personagens Mulheres")
p1 <- ggplot(dados1, aes(Ano,MedFalaM)) + labs(title = "Mediana do N?mero de Falas Femininas em Filmes por Ano") + geom_line(color = "#7dcadb") + labs(y = "Mediana de Falas Femininas")
ggplotly(p, width = 800, height = 500)
ggplotly(p1, width= 800, height = 500)
dados.agrup <- dados[-c(1,2)]
set.seed(44)
wss <- (nrow(dados.agrup)-1)*sum(apply(dados.agrup,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(dados.agrup,
centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares")
# Nesse caso 3 eh visto como o numero apropriado entao:
# Clustering
dadosCluster <- kmeans(dados.agrup, 3, nstart = 40)
aggregate(dados.agrup,by=list(dadosCluster$cluster),FUN=mean)
# append cluster
dados.agrup <- data.frame(dados.agrup, dadosCluster$cluster)
names(dados.agrup)[names(dados.agrup)=="dadosCluster.cluster"] <- "cluster"
p1 <- dados.agrup %>% filter(cluster=='1') %>%
plot_ly(type = 'parcoords',
line = list(color ="#c97cc4"),
dimensions = list(
list(range = c(1,16),
label = 'Numero de Mulheres', values = ~Numero.de.Mulheres),
list(range = c(101,26000),
label = 'Palavras Ditas por Mulheres', values = ~Palavras.Ditas.por.Mulheres),
list(range = c(1,30),
label = 'Numero de Homens', values = ~Numero.de.Homens),
list(range = c(101,57950),
label = 'Palavras Ditas por Homens', values = ~Palavras.Ditas.por.Homens)
)
)
p2 <- dados.agrup %>% filter(cluster=='2') %>%
plot_ly(type = 'parcoords',
line = list(color ="#ef5d8b"),
dimensions = list(
list(range = c(1,16),
label = 'Numero de Mulheres', values = ~Numero.de.Mulheres),
list(range = c(101,26000),
label = 'Palavras Ditas por Mulheres', values = ~Palavras.Ditas.por.Mulheres),
list(range = c(1,30),
label = 'Numero de Homens', values = ~Numero.de.Homens),
list(range = c(101,57950),
label = 'Palavras Ditas por Homens', values = ~Palavras.Ditas.por.Homens)
)
)
p3 <- dados.agrup %>% filter(cluster=='3') %>%
plot_ly(type = 'parcoords',
line = list(color ="#9961c6"),
dimensions = list(
list(range = c(1,16),
label = 'Numero de Mulheres', values = ~Numero.de.Mulheres),
list(range = c(101,26000),
label = 'Palavras Ditas por Mulheres', values = ~Palavras.Ditas.por.Mulheres),
list(range = c(1,30),
label = 'Numero de Homens', values = ~Numero.de.Homens),
list(range = c(101,57950),
label = 'Palavras Ditas por Homens', values = ~Palavras.Ditas.por.Homens)
)
)
p1
p2
p3
View(dados_f)
View(dados_f)
View(dados.agrup)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(resample) # <-- Para bootstrap!
library(GGally)
library(grid)
library(ggplot2)
theme_set(theme_bw())
dados  = read_csv("dados.csv") %>%
filter(file_extension %in% c("js", "py"))
dados$date <- paste(dados$the_year, dados$the_month, dados$month_day, sep = "-")
dados = dados %>%
mutate(day = weekdays(as.Date(date,'%Y-%m-%d')))
semana <- dados %>%
filter(day %in% c("segunda-feira", "terça-feira",  "quarta-feira",  "quinta-feira",  "sexta-feira"))
fim.semana <- dados %>%
filter(day %in% c("sábado", "domingo"))
semana.py <- semana %>%
filter(file_extension %in% "py")
semana.js <- semana %>%
filter(file_extension %in% "js")
fim.semana.py <- fim.semana %>%
filter(file_extension %in% "py")
fim.semana.js <- fim.semana %>%
filter(file_extension %in% "js")
dados.semana <- semana %>%
group_by(file_extension) %>%
summarise(media = mean(users), mediana = median(users), sum = sum(users), numobser = n())
dados.final.semana <- fim.semana %>%
group_by(file_extension) %>%
summarise(media = mean(users), mediana = median(users), sum = sum(users), numobser = n())
ggplot(data = dados.semana, aes(x = file_extension, y = media, fill = sum)) +
geom_bar(stat = "identity") +
ggtitle("Durante a semana")
ggplot(data = dados.final.semana, aes(x = file_extension, y = media, fill = sum)) +
geom_bar(stat = "identity") +
ggtitle("Final de semana")
glimpse(dados.semana)
glimpse(dados.final.semana)
repeticoes = 4000 # pelo menos 2000, mas mais não faz mal.
exp_com_bootstrap <- function(x){
boot_x <- sample(x, size = NROW(x), replace = TRUE) # aqui é o bootstrap
return(mean(boot_x))
}
#Python
# Agora o input das reamostragens é a amostra!
experimentos.semana.py = data_frame(i = 1:repeticoes) %>%
rowwise() %>%
mutate(media_exp = exp_com_bootstrap(semana.py$users)) # <- Aqui!
experimentos.fim.semana.py = data_frame(i = 1:repeticoes) %>%
rowwise() %>%
mutate(media_exp = exp_com_bootstrap(fim.semana.py$users)) # <- Aqui!
# IC com 95%:
alpha = .05
ci.semana.py = quantile(experimentos.semana.py$media_exp,
probs = c(alpha/2, 1 - alpha/2))
# IC com 95%:
alpha = .05
ci.fim.semana.py = quantile(experimentos.fim.semana.py$media_exp,
probs = c(alpha/2, 1 - alpha/2))
ggplot(experimentos.semana.py, aes(x = media_exp)) +
geom_histogram(binwidth = 1, colour = "darkorange", fill = "white") +
geom_vline(aes(xintercept = ci.semana.py[[1]]), colour = "blue") +
geom_vline(aes(xintercept = ci.semana.py[[2]]), colour = "blue") +
ggtitle("Média de usuários dos arquivos .py durante a semana")
ggplot(experimentos.fim.semana.py, aes(x = media_exp)) +
geom_histogram(binwidth = 1, colour = "darkorange", fill = "white") +
geom_vline(aes(xintercept = ci.fim.semana.py[[1]]), colour = "blue") +
geom_vline(aes(xintercept = ci.fim.semana.py[[2]]), colour = "blue") +
ggtitle("Média de usuários dos arquivos .py durante o final de semana")
# Java Script
experimentos.semana.js = data_frame(i = 1:repeticoes) %>%
rowwise() %>%
mutate(media_exp = exp_com_bootstrap(semana.js$users)) # <- Aqui!
experimentos.fim.semana.js = data_frame(i = 1:repeticoes) %>%
rowwise() %>%
mutate(media_exp = exp_com_bootstrap(fim.semana.js$users)) # <- Aqui!
# IC com 95%:
alpha = .05
ci.semana.js = quantile(experimentos.semana.js$media_exp,
probs = c(alpha/2, 1 - alpha/2))
# IC com 95%:
alpha = .05
ci.fim.semana.js = quantile(experimentos.fim.semana.js$media_exp,
probs = c(alpha/2, 1 - alpha/2))
ggplot(experimentos.semana.js, aes(x = media_exp)) +
geom_histogram(binwidth = 1, colour = "darkorange", fill = "white") +
geom_vline(aes(xintercept = ci.semana.js[[1]]), colour = "blue") +
geom_vline(aes(xintercept = ci.semana.js[[2]]), colour = "blue") +
ggtitle("Uso durante a semana arquivos extensão .js")
ggplot(experimentos.fim.semana.js, aes(x = media_exp)) +
geom_histogram(binwidth = 1, colour = "darkorange", fill = "white") +
geom_vline(aes(xintercept = ci.fim.semana.js[[1]]), colour = "blue") +
geom_vline(aes(xintercept = ci.fim.semana.js[[2]]), colour = "blue") +
ggtitle("Uso durante o final de semana arquivos extensão .js")
